# ESMValTool
# recipe_wflow.yml
---
documentation:
  description: Pre-processes climate data for the WFlow hydrological model.
  authors:
    - kalverla_peter
    - camphuijsen_jaro
    - alidoost_sarah
  projects: ['ewatercycle']
  references: ['acknow_project']

preprocessors:
  crop_basin: &crop_basin
    extract_region:
      start_longitude: -72.75
      end_longitude: -68
      start_latitude: 40
      end_latitude: 44.75
  hourly_mean:
    <<: *crop_basin
    # extract_time:
    #   end_year: 1990
    #   end_month: 1
    #   end_day: 3

diagnostics:
  # diagnostic_daily:
  #   description: WFlow input preprocessor for daily data
  #   additional_datasets:
  #     - {dataset: ERA-Interim, project: OBS6, tier: 3, type: reanaly, version: 1}
  #   variables:
  #     tas: &var_daily
  #       mip: day
  #       preprocessor: crop_basin
  #       start_year: 1999
  #       end_year: 2001
  #     pr: *var_daily
  #     orog:
  #       mip: fx
  #       start_year: 1999
  #       end_year: 1999
  #       preprocessor: crop_basin
  #     # evspsblpot:  # doesn't exist.
  #     # Reconstruct evspsblpot using:
  #     psl: *var_daily
  #     rsds: *var_daily
  #     rsdt:
  #       <<: *var_daily
  #       mip: CFday
  #   scripts:
  #     script:
  #       script: hydrology/wflow.py
  #       basin_name: Merrimack
  #       dataset: ERA-Interim
  #       startyear: '1999'
  #       endyear: '2001'
  #       dem_file: 'wflow/wflow_dem_Merrimack.nc'

  diagnostic_hourly:
    description: WFlow input preprocessor for hourly data
    additional_datasets:
      - {dataset: ERA5, project: OBS6, tier: 3, type: reanaly, version: 1}
    variables:
      orog:
        mip: fx
        start_year: 1999
        end_year: 1999
        preprocessor: crop_basin
      tas: &var_hourly
        mip: E1hr
        preprocessor: hourly_mean
        start_year: 1999
        end_year: 2001
      pr: *var_hourly
      # Reconstruct evspsblpot similar to ERA-Interim:
      psl: *var_hourly
      rsds: *var_hourly
      rsdt: *var_hourly
    scripts:
      script:
        script: hydrology/wflow.py
        basin_name: Merrimack
        dataset: ERA5
        startyear: '1999'
        endyear: '2001'
        dem_file: 'wflow/wflow_dem_Merrimack.nc'




        
